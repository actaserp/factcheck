<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<body>

</body>
</html><!DOCTYPE html>
<html lang="ko">
<style>
    .btn-clear {
        display: none !important; /* 강제로 숨김 */
    }

    .btn-close {
        display: none !important; /* 강제로 숨김 */
    }


    .tab-item {
        display: none;  /* 기본적으로 모든 탭 내용을 숨깁니다 */
    }

    .tab-item.active {
        display: block;  /* 'active' 클래스가 있을 때만 해당 탭 내용을 표시 */
    }
    .tab-links {display: flex; margin-left: 1px; margin-bottom: -1px; overflow: hidden;}
    .tab-links li {position: relative;}
    .tab-links li:first-child a {border-radius: 6px 0 0 0;}
    .tab-links li:last-child a {border-radius: 0 6px 0 0;}
    .tab-links li a {display: inline-flex; justify-content: center; min-width: 120px; padding: 3px 32px 15px 32px; color: #808080; font-size: 18px; font-weight: 700; text-align: center; transition: all .3s; border-bottom: 3px solid #C6C6C6;}
    .tab-links li:hover a {color: #4D4D4D; font-weight: 700; border-bottom: 3px solid #4D4D4D;}
    .tab-links li.active a {color: #03428E; font-weight: 700; border-bottom: 3px solid #03428E;}
    section .tab-links {}
    section .tab-links li a {padding: 8px 10px; margin-right: -1px; border: 1px solid #E4E4E4; background-color: #fff; color: #808080;}
    section .tab-links li:first-child a {border-radius: 12px 0 0 12px;}
    section .tab-links li:last-child a {border-radius: 0 12px 12px 0; margin-right: 0;}
    section .tab-links li.active a {background-color: #3069B3; color: #fff;}
    .tab-links-sub li {position: relative;}
    .tab-links-sub li a {display: inline-flex; border: 1px solid #E4E4E4; justify-content: center; min-width: 90px; padding: 8px 32px 8px 32px; background-color: #fff; color: #333333; font-size: 17px; font-weight: 700; text-align: center; transition: all .3s;}
    .tab-links-sub li:hover a {border-radius: 3px 0 0 3px; color: #4D4D4D; border: 1px solid #E4E4E4; border-right:1px solid #E4E4E4; border-left:1px solid #E4E4E4; background-color: #f5f6fa;}
    .tab-links-sub li:first-child a {border-radius: 3px 0 0 3px; border-right:0}
    .tab-links-sub li:first-child:hover a {border-radius: 3px 0 0 3px; color: #4D4D4D; border: 1px solid #b3b3b3; border-right:0; background-color: #f5f6fa;}
    .tab-links-sub li:last-child a {border-radius: 0 3px 3px 0; border-left:0}
    .tab-links-sub li:last-child:hover a {color: #4D4D4D; border: 1px solid #b3b3b3; border-left:0; background-color: #f5f6fa; border-radius: 0 3px 3px 0; border-left:0}
    .tab-links-sub li.active a {background-color: #2EC9D6; color: #fff; font-weight: 70

</style>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>[KTFOMS] AI 기반 연료전지 인프라 구축 - 모바일</title>
  <link rel="shortcut icon" href="/img/favicon.ico">
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/> <!-- Slide css -->
  <link rel="stylesheet" href="/resource/ax5ui/ax5ui.all.css">
  <link rel="stylesheet" type="text/css" href="/assets_mobile/css/import.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>

  <script src="/assets_mobile/js/ui.js"></script> <!-- Common js -->
  <script th:inline="javascript">
    var sandanData = /*[[${session.sandanList}]]*/ [];
  </script>


  <script type="text/javascript" src="/resource/ax5ui/ax5ui.all.min.js?v=1000"></script>

  <script type="text/javascript" src="/js/ax5commUtil.js?v=1070"></script>

  <script src="/js/common.js?v=1060"></script>
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script> <!-- Slide js -->
  <script src="/js/Mobile.js"></script>
</head>

<body>
<div class="mobile-wrapper page-ticket-list"><!-- ★페이지 Class명 -->
  <!-- [모바일] 헤더  -->
  <div class="mobile-layout-header">
    <header>
      <div class="left">
        <a href="#" title="전체메뉴" class="logo">
        </a>
      </div>
      <div class="center" style="margin-left:35px;">
        <h2>등기부 발급 조회</h2>
      </div>
      <div class="right">
        <a href="#" title="전체메뉴" class="btn-menu">
          <img src="/assets_mobile/images/icon/btn-menu.svg" alt="전체메뉴 아이콘">
        </a>
      </div>
    </header>
  </div> <!-- //mobile-layout-header end-->

  <!-- [모바일] 메뉴  -->
  <div th:insert="~{mobile/mobile_menu :: mobile_menu}"></div>
  <!-- [모바일] 컨덴츠  -->
  <div class="mobile-layout-contents">
    <!--- (레이아웃) Contents 영역 -->
    <div class="layout-contents">
      <!-- 검색 영역  -->
      <div class="search-wrap">
        <div class="srch-tit aco-hd">
          <p>기본검색</p>
          <a href="#" title="열기/닫기" class="btn-aco">
            <img src="/assets_mobile/images/icon/ico-down.svg" alt="열기/닫기">
          </a>
        </div>
        <div class="srch-cont aco-cont">
          <dl>
            <dt>
              조회일자<span class="eq">*</span>
            </dt>
            <dd>
              <ul class="date-box">
                <li>
                  <input type="date" id="startDate" name="startDate">
                  <label for="startDate" class="hide">시작일</label>
                </li>
                <li>
                  <input type="date" id="endDate" name="endDate">
                  <label for="endDate" class="hide">종료일</label>
                </li>
              </ul>
            </dd>
          </dl>
          <dl>
            <dt>검색</dt>
            <dd>
              <div style="display: flex; gap: 10px">
                <div style="width: 100%">
                  <input type="text" id="SearchKeywords" placeholder="조회할 주소를 입력해주세요">
                </div></div>
            </dd>
          </dl>
          <div class="srch-btn">
            <button class="btn-dark" onclick="handleSearch()">조회</button>
          </div>
        </div>
      </div>
      <!-- 컨텐츠 영역  -->
      <div class="contents-wrap">
        <div class="list-top-wrap">
          <div class="list-num">
            목록 <span class="blue">- 건</span>
          </div>
        </div>
        <div id="addressWrap" class="contents-wrap">

        </div> <!--//card-wrap end-->
      </div> <!--// contents-wrap end-->
    </div> <!--//layout-contents end -->

  </div> <!-- //mobile-layout-contents end-->

  <!--<div class="mobile-layout-popup" id="popup-history">
    <div class="popup-overlay"></div>
    <div class="popup-wrapper">
      <div class="popup-title">
        <h3>상세내용</h3>
      </div>
      <div class="popup-contents">
        <div class="table-wrap">
          <div class="write-wrap">
            <div class="row">
              <div class="tab-wrap">
                <div class="tab-buttons">
                  <button onclick="changeTable('main')">표제부</button>
                  <button onclick="changeTable('sub1')">갑구</button>
                  <button onclick="changeTable('sub2')">을구</button>
                </div>

                <section class="tab-item" id="dynamic-table">
                  <table class="write-table"
                         style="width: 100%; border-collapse: collapse; table-layout: fixed;">
                    <caption id="table-title" style="text-align: left; margin-bottom: 8px;">상세테이블</caption>
                    <thead id="table-head"></thead>
                    <tbody id="table-body"></tbody>
                  </table>
                </section>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="popup-button">
        <button class="btn-popup-close btn-navy">확인</button>
      </div>
    </div>
  </div>-->
  <div class="mobile-layout-popup" id="popup-history" >
    <div class="popup-overlay"></div>
    <div class="popup-wrapper" >
      <div class="popup-title">
        <h3>상세내용</h3>
        <!--                <a href="#a" title="팝업닫기" class="btn-popup-close">-->
        <!--                    <img src="/assets_mobile/images/icon/btn-popup-close.svg" alt="닫기">-->
        <!--                </a>-->
      </div>
      <div class="popup-contents">
        <div class="table-wrap">
          <div class="write-wrap">
            <div class="row">
              <section>
                <div class="tab-wrap">
                  <ul class="tab-links" style="margin-bottom: 10px;">
                    <li><a href="#main" name="tabs_basic">표제부</a></li>
                    <li><a href="#sub1" name="tab_production">갑구</a></li>
                    <li><a href="#sub2" name="tab_production">을구</a></li>
                  </ul>

                  <section class="tab-item" id="main">
                    <table class="write-table"
                           style="width: 100%; border-collapse: collapse; table-layout: fixed;">
                      <caption style="text-align: left; margin-bottom: 8px;">상세테이블</caption>
                      <thead>
                      <tr>
                        <th colspan="4" style="text-align: center;">표 제 부 (건물의 표시)</th>
                      </tr>

                      </thead>
                      <tbody>
                      <tr>
                        <th style="text-align: center; width: 7%; padding: 5px; border: 1px solid #ddd;">
                          <label>접수</label>
                        </th>
                        <td style="width: 15%; padding: 5px; border: 1px solid #ddd;" colspan="3">

                        </td>
                      </tr>
                      <tr>
                        <th style="text-align: center; width: 7%; padding: 5px; border: 1px solid #ddd;">
                          <label>소재지번,건물명칭 및 번호</label>
                        </th>
                        <td style="width: 15%; padding: 5px; border: 1px solid #ddd;" colspan="3">

                        </td>
                      </tr>

                      <tr>
                        <th style="text-align: center; width: 7%; padding: 5px; border: 1px solid #ddd;">
                          <label>소재지번</label>
                        </th>
                        <td style="width: 15%; padding: 5px; border: 1px solid #ddd;" colspan="3">

                        </td>
                      </tr>

                      <tr>
                        <th style="text-align: center; width: 7%; padding: 5px; border: 1px solid #ddd;">
                          <label>지목</label>
                        </th>
                        <td style="width: 15%; padding: 5px; border: 1px solid #ddd;">

                        </td>

                        <th style="text-align: center; width: 7%; padding: 5px; border: 1px solid #ddd;">
                          <label>면적</label>
                        </th>
                        <td style="width: 15%; padding: 5px; border: 1px solid #ddd;">

                        </td>
                      </tr>

                      <tr>
                        <th style="text-align: center; width: 7%; padding: 5px; border: 1px solid #ddd;">
                          <label>등기원인 및 기타사항</label>
                        </th>
                        <td style="width: 15%; padding: 5px; border: 1px solid #ddd;" colspan="3">
                        </td>
                      </tr>
                      </tbody>
                    </table>
                  </section>


                  <section class="tab-item" id="sub1">
                    <table class="write-table"
                           style="width: 100%; border-collapse: collapse; table-layout: fixed;">
                      <caption style="text-align: left; margin-bottom: 8px;">상세테이블</caption>
                      <thead>
                      <tr>
                        <th colspan="4" style="text-align: center;">갑 구 (소유권에 관한 사항)</th>
                      </tr>
                      <tr>
                        <th>
                          표시번호
                        </th>
                        <th>
                          등기목적
                        </th>
                        <th>
                          접수
                        </th>
                        <th>
                          등기원인
                        </th>
                      </tr>

                      </thead>
                      <tbody>

                      <tr>
                        <td>
                          1
                        </td>
                        <td>
                          공유자전원지분전부 이전
                        </td>
                        <td>
                          1998년12월28일 제78258호
                        </td>
                        <td>
                          2010년8월26일 신탁재산의귀속  신탁재산의 귀속
                        </td>

                      </tr>
                      <tr>
                        <th>권리자 및 기타사항</th>
                        <td colspan="3">
                          소유자  노순덕  530408-******* 서울 서초구 방배동 537-25 현대아트빌라 202호
                        </td>
                      </tr>
                      </tbody>
                    </table>
                  </section>

                  <section class="tab-item" id="sub2">
                    <table class="write-table"
                           style="width: 100%; border-collapse: collapse; table-layout: fixed;">
                      <caption style="text-align: left; margin-bottom: 8px;">상세테이블</caption>
                      <thead>
                      <tr>
                        <th colspan="4" style="text-align: center;">을 구 (소유권 이외의 권리에 관한 사항)</th>
                      </tr>
                      <tr>
                        <th>
                          표시번호
                        </th>
                        <th>
                          등기목적
                        </th>
                        <th>
                          접수
                        </th>
                        <th>
                          등기원인
                        </th>
                      </tr>
                      </thead>
                      <tbody>
                      <tr>
                        <td>
                          1
                        </td>
                        <td>
                          1번근저당권변경
                        </td>
                        <td>
                          2022년1월27일 제9407호
                        </td>
                        <td>
                          2022년1월13일 변경계약
                        </td>
                      </tr>
                      <tr>
                        <th colspan="1">
                          권리자 및 기타사항
                        </th>
                        <td colspan="3">
                          &채권최고액  금108,000,000원&
                        </td>
                      </tr>

                      <tr>
                        <td>
                          2
                        </td>
                        <td>

                        </td>
                        <td>

                        </td>
                        <td>

                        </td>
                      </tr>
                      <tr>
                        <th colspan="1">
                          권리자 및 기타사항
                        </th>
                        <td colspan="3">
                          1번 등기는 건물만에 관한 것임 2022년3월2일  부기
                        </td>
                      </tr>
                      <tr>
                        <td>
                          3
                        </td>
                        <td>
                          1번근저당권변경
                        </td>
                        <td>

                        </td>
                        <td>
                          2022년1월27일 근저당권변경계 약
                        </td>
                      </tr>
                      <tr>
                        <th colspan="1">
                          권리자 및 기타사항
                        </th>
                        <td colspan="3">
                          채권최고액  금108,000,000원 공동담보 해제 2022년3월2일  부기
                        </td>
                      </tr>
                      </tbody>
                    </table>
                  </section>
                </div>
              </section>
            </div>
          </div>
        </div>
      </div>
      <div class="popup-button">
        <button class="btn-popup-close btn-navy">확인</button>
      </div>
    </div>
  </div>



</div> <!-- //page-wrapper end-->

<script th:inline="javascript">
  // // Thymeleaf에서 값 설정: Null 체크와 기본값 처리
  // var groupid = [[${session.groupid != null ? session.groupid : 'null'}]];
  // var id = /*[[${id != null ? id : 'null'}]]*/;
  // var groupname = /*[[${groupname != null ? groupname : 'null'}]]*/;
  // var username = /*[[${username != null ? username : 'null'}]]*/;
  //
  // // 로컬스토리지에 값 유지 (null 또는 빈 문자열은 저장하지 않음)
  // if (groupid && groupid !== 'null') localStorage.setItem('groupid', groupid);
  // if (id && id !== 'null') localStorage.setItem('id', id);
  // if (username && username !== 'null') localStorage.setItem('username', username);
  // if (groupname && groupname !== 'null') localStorage.setItem('groupname', groupname);
</script>


<script type="text/javascript">

  document.readyState === 'complete' ? init() : window.onload = init;
  // 오늘 날짜 설정
  const date = new Date();
  date.setHours(date.getHours() + 9); // UTC+9로 한국 시간 설정
  const today = date.toISOString().split('T')[0];
  const currentYear = date.getFullYear();

  // 기본값 설정 (올해 1월 1일 ~ 오늘)
  document.getElementById('startDate').value = `${currentYear}-01-01`;
  document.getElementById('endDate').value = today;

  function init() {
    fetchListData();
  }

  // 데이터를 받아와 카드 렌더링
  function fetchListData() {
    $.ajax({
      url: '/api/IssueInquiry/List',
      type: 'GET',
      data: {
        'startDate': $('#startDate').val(),
        'endDate': $('#endDate').val(),
        'SearchKeywords': $('#SearchKeywords').val()
      },
      success: function (data) {
        console.log("서버 응답 데이터:", data);
        console.log("작업목록:", data.data);
        // 데이터가 올바른지 확인
        if (!data || !data.data || !Array.isArray(data.data)) {
          console.error("데이터가 올바르지 않습니다.");
          return;
        }

        // 목록 건수 업데이트
        const listNumElement = document.querySelector('.list-num .blue');
        if (listNumElement) {
          listNumElement.textContent = `${data.data.length} 건`;
        }

        // 주소 리스트 업데이트
        const listAddressWrap = document.getElementById('addressWrap');
        if (!listAddressWrap) {
          console.error("addressWrap 요소를 찾을 수 없습니다.");
          return;
        }

        listAddressWrap.innerHTML = ''; // 기존 내용 초기화
        const availableColors = ['card-blue', 'card-green', 'card-black', 'card-red', 'card-yellow', 'card-purple'];
        let colorIndex = 0;
        let htmlContent = '';

        const selectedValue = $('#property').val();

        data.data.forEach(item => {
          const cardColor = availableColors[colorIndex];
          colorIndex = (colorIndex + 1) % availableColors.length;

          let buttonsHtml = `<button class="btn btn-popup-open" data-popup="popup-history" title="상세보기">
                            상세보기
                        </button>`;

          // 날짜 포맷 변경
          const formattedDate = item.RELASTDATE.substring(0, 4) + '-' + item.RELASTDATE.substring(4, 6) + '-' + item.RELASTDATE.substring(6, 8);
          const formattedLastDate = item.RLASTDATE
            ? item.RLASTDATE.substring(0, 4) + '-' + item.RLASTDATE.substring(4, 6) + '-' + item.RLASTDATE.substring(6, 8)
            : '';

          htmlContent += `
                        <div class="card-box ${cardColor}" data-realadd="${item.REALADD}" data-realid="${item.REALID}">
                            <div class="card-cont">
                                <dl>
                                    <dt>주소</dt>
                                    <dd>${item.REALADD}</dd>
                                </dl>
                                 ${
            (selectedValue === "most_viewed_property" || selectedValue === "popular_property")
              ? `<dl>
                                        <dt>최근조회날짜</dt>
                                        <dd>${formattedLastDate}</dd>
                                    </dl>`
              : `<dl>
                                        <dt>조회날짜</dt>
                                        <dd>${formattedDate}</dd>
                                    </dl>`
          }
                                 <dl>
                                    <dt>판정점수</dt>
                                    <dd>${item.REALSCORE}</dd>
                                </dl>

                              ${ (selectedValue === "most_viewed_property" || selectedValue === "popular_property") ? `
                                <dl>
                                    <dt>조회수</dt>
                                    <dd>${item.view_count}</dd>
                                </dl>
                                ` : '' }

                            </div>
                                ${buttonsHtml}
                        </div>
                    `;
        });

        listAddressWrap.innerHTML = htmlContent;

        /*$("#addressWrap").off("click").on("click", ".btn-popup-open[data-popup='popup-history']", function () {
          const cardBox = $(this).closest('.card-box');
          const realAdd = cardBox.attr('data-realadd');
          const realId = cardBox.attr('data-realid');

          if (!realId) {
            console.error("realId가 존재하지 않습니다.");
            return;
          }

          // 팝업 타이틀 업데이트
          $("#popup-history .popup-title h3").text(`${realAdd} 상세내용`);

          // 팝업 열기
          $("#popup-history").addClass("open");

          // 모든 탭 숨기고 'main' 탭만 활성화
          $(".tab-item").removeClass("active");
          $("#dynamic-table").addClass("active"); // 동적으로 테이블을 업데이트할 단일 섹션 사용

          // AJAX 요청 (realId로 상세 정보 조회)
          $.ajax({
            url: "/api/IssueInquiry",
            type: "GET",
            data: { realId: realId },
            dataType: "json",
            success: function (response) {
              if (response.success) {
                const history = response.history;

                // 표제부(main) 데이터 설정
                data.main.body = `
                    <tr>
                        <th>접수</th>
                        <td colspan="3">${history.REQDATE || "정보 없음"}</td>
                    </tr>
                    <tr>
                        <th>소재지번, 건물명칭 및 번호</th>
                        <td colspan="3">${history.address || "정보 없음"}</td>
                    </tr>
                    <tr>
                        <th>소재지번</th>
                        <td colspan="3">${history.REALADD || "정보 없음"}</td>
                    </tr>
                    <tr>
                        <th>지목</th>
                        <td>${history.REJIMOK || "정보 없음"}</td>
                        <th>면적</th>
                        <td>${history.REAREA || "정보 없음"}</td>
                    </tr>
                `;

                // 갑구(sub1) 데이터 설정
                data.sub1.body = history.ownerships.map(ownership => `
                    <tr>
                        <td>${ownership.index || ""}</td>
                        <td>${ownership.Receve || ""}</td>  <!--접수-->
                        <td>${ownership.RgsAimCont || ""}</td>  <!--등기 목적 -->
                        <td>${ownership.RgsCaus || ""}</td> <!--등기 원인-->
                        <td>${ownership.NomprsAndEtc || ""}</td><!--권리자 밒 기타사항-->
                    </tr>
                `).join("");

                // 을구(sub2) 데이터 설정
                data.sub2.body = history.rights.map(right => `
                    <tr>
                        <td>${right.index || ""}</td>
                        <td>${right.purpose || ""}</td>
                        <td>${right.receiptDate || ""}</td>
                        <td>${right.reason || ""}</td>
                        <td>${right.details || ""}</td>
                    </tr>
                `).join("");

                // 초기 테이블 표시 (표제부 기준)
                changeTable('main');
              } else {
                console.error("데이터 조회 실패:", response.message);
              }
            },
            error: function (xhr, status, error) {
              console.error("AJAX 요청 실패:", status, error);
              console.error("응답 내용:", xhr.responseText);
            }
          });
        });*/
        listAddressWrap.addEventListener('click', (event) => {
          const button = event.target.closest('.btn-popup-open[data-popup="popup-history"]');
          if (!button) return; // 클릭된 요소가 버튼이 아닌 경우 무시

          const cardBox = button.closest('.card-box');

          const realAdd = cardBox.getAttribute('data-realadd');
          const resido = cardBox.getAttribute('data-resido') || '';
          const regdate = cardBox.getAttribute('data-regdate') || '';
          const regugun = cardBox.getAttribute('data-regugun') || '';
          const rejimok = cardBox.getAttribute('data-rejimok') || '';
          const rearea = cardBox.getAttribute('data-rearea') || '';


          // 팝업 타이틀 업데이트
          const popupTitle = document.querySelector("#popup-history .popup-title h3");
          if (popupTitle) {
            popupTitle.textContent = `${realAdd} 상세내용`;
          }

          // 날짜 포맷 변경
          const formattedRegDate = regdate
            ? regdate.substring(0, 4) + '년' + regdate.substring(4, 6) + '월' + regdate.substring(6, 8) + '일'
            : '';

          const tds = document.querySelectorAll("#popup-history td[colspan='3']");
          if(tds.length > 0){
            tds[0].textContent = formattedRegDate;
            tds[1].textContent = realAdd;
            tds[2].textContent = resido + " " + regugun;
          }else {
            console.error("해당 요소를 찾을 수 없습니다.");
          }
          const rows = document.querySelector("#popup-history table tbody").getElementsByTagName("tr");
          if (rows.length >= 4) {
            const tds = rows[3].getElementsByTagName("td");
            if (tds.length >= 2) {
              tds[0].textContent = rejimok;
              tds[1].textContent = rearea;
            }
          }

          const ranknoA = cardBox.getAttribute('data-ranknoA');
          const aimcontA = cardBox.getAttribute('data-aimcontA') || '';
          const receveA = cardBox.getAttribute('data-receveA') || '';
          const rgscausA = cardBox.getAttribute('data-rgscausA') || '';
          const etcA = cardBox.getAttribute('data-etcA') || '';

          const sub1Table = document.querySelector("#sub1 table tbody");


          const firstRow = sub1Table.insertRow();
          firstRow.innerHTML = `<td>${ranknoA}</td><td>${aimcontA}</td><td>${receveA}</td><td>${rgscausA}</td>`;


          const secondRow = sub1Table.insertRow();
          secondRow.innerHTML = `<td colspan="4">${etcA}</td>`;


          if (etcA.includes(',')) {
            const etcValues = etcA.split(','); // 쉼표로 구분된 여러 값 분리
            etcValues.forEach(value => {
              const additionalRow = sub1Table.insertRow();
              additionalRow.innerHTML = `<td colspan="4">${value.trim()}</td>`; // 각 값은 새로운 행으로 추가
            });
          }




          // 팝업 열기
          const popupHistory = document.getElementById("popup-history");
          popupHistory.classList.add("open");

          // 모든 탭 내용을 숨깁니다
          const tabItems = popupHistory.querySelectorAll('.tab-item');
          tabItems.forEach(item => {
            item.classList.remove('active');  // 모든 탭 내용 숨기기
          });

          // 'main' 탭만 활성화
          const mainTab = popupHistory.querySelector('#main');
          if (mainTab) {
            mainTab.classList.add('active');  // 'main' 탭만 표시
          }

          const goyuNum = cardBox.getAttribute('data-Goyu');
        });
      },
      error: function (xhr, status, error) {
        console.error("AJAX 요청 실패:", status, error);
        console.error("응답 내용:", xhr.responseText);
      }
    });
  }

  /*  // 데이터 찾기
                 const item = data2.find(d => d.pin === goyuNum);
                 if (item) {
                     searchaddress(item);
                 }*/
  function openModal(popupId) {
    let popup = document.getElementById(popupId);
    let overlay = document.querySelector('.popup-overlay');

    if (popup && overlay) {
      popup.classList.add('active'); // 팝업 활성화
      overlay.style.display = 'block'; // 오버레이 보이기
    } else {
      console.error('popup2 또는 popup-overlay 요소를 찾을 수 없습니다.');
    }
  }

  function ModalClose(popupId) {
    let popup = document.getElementById(popupId);
    let overlay = document.querySelector('.popup-overlay');

    if (popup && overlay) {
      popup.classList.remove('active'); // 팝업 비활성화
      overlay.style.display = 'none'; // 오버레이 숨기기
    }
  }

  function handleSearch() {
    fetchListData();
    closeSearch();
  }

  // 조회버튼 클릭시 검색창 close
  function closeSearch() {
    document.querySelector('.btn-aco').click();
  }

</script>
</body>
</html>
