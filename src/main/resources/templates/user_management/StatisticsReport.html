<html layout:decorate="~{layout_page}" xmlns:layout="http://www.w3.org/1999/xhtml">

<meta name="_csrf" content="${_csrf.token}">
<meta name="_csrf_header" content="${_csrf.headerName}">
<style>
    /* ë¶€ëª¨ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
    .div selection-container {
        display: flex;
        gap: 20px; /* ë‘ dl ê°„ì˜ ê°„ê²© */
        align-items: flex-start; /* ë‘ dlì˜ ìœ„ìª½ ì •ë ¬ */
    }

    /* ê° dlì˜ ìŠ¤íƒ€ì¼ */
    .selection-container dl {
        width: 100%; /* ê° dlì˜ ë„ˆë¹„ë¥¼ ë™ì¼í•˜ê²Œ ì„¤ì • */
    }

    dt {
        font-weight: bold;
        margin-bottom: 10px;
    }

    .selection-container srch-box {
        margin-top: 10px;
    }

    /* ë‚´ë¶€ ìš”ì†Œ ê°„ ê°„ê²© ì¡°ì • */
    label, select {
        display: block;
        margin-bottom: 10px;
    }

</style>

<th:block layout:fragment="content">


  <div class="layout-contents">
    <!-- Page Title -->
    <div class="page-title-wrap">
      <div class="left">
        <h2>í†µê³„ë³´ê³ ì„œ</h2>
        <!--                <a title="ë¶ë§ˆí¬" class="bookmark toggle">-->
        <!--                    ë‚´ë©”ë‰´-->
        <!--                </a>-->
      </div>
      <ul class="page-navi">
        <li><img src="/images/icon/ico-nav-home.svg" alt="í™ˆì•„ì´ì½˜"></li>
        <li>íšŒì›ê´€ë¦¬</li>
        <li>í†µê³„ë³´ê³ ì„œ</li>
      </ul>
    </div>
    <div class="tab-wrap">
      <div class="tab-contents">
        <!-- Section -->
        <section class="tab-item" id="tab1" style="height: 850px;">
          <div class="section-top">
            <form id="searchForm">
              <div class="search-wrap">
                <dl>
                  <dt>
                   ë°œê¸‰ ê¸°ê°„<span class="eq">*</span>
                  </dt>
                  <dd>
                    <ul class="date-box">
                      <li>
                        <input class="tac w150 " type="date" id="startDate" name="date_from"/>
                        <label for="startDate" class="hide">ì‹œì‘ì¼</label>
                      </li>
                      <li>
                        <input class="tac w150" type="date" id="endDate" name="date_to"/>
                        <label for="endDate" class="hide">ì¢…ë£Œì¼</label>
                      </li>
                    </ul>
                  </dd>
                </dl>
                <dl>
                  <dt><span class="eq"></span></dt>
                  <dd>
                    <li>
                      <a class="btn btn-delete" title="ê²€ìƒ‰" id="btnSearch1"
                         onclick="DefaultData()">
                        <img src="/images/icon/btn-srch.svg" alt="ê²€ìƒ‰ ì•„ì´ì½˜">
                        ê²€ìƒ‰
                      </a>
                    </li>
                  </dd>
                </dl>
              </div>
            </form>
          </div> <!--//section-top end -->
          <div class="container-fluid">
            <div class="apply" style="display: flex; gap: 20px;">
            <div id="selection-Row" style="display: flex; gap: 20px; margin-bottom: 5px;">
              <dl style="display: flex; flex-direction: column; gap: 4px;">
                <dt>
                  <label for="RowSelect">í–‰ ì„ íƒ<span class="eq"></span></label>
                </dt>
                <dd style="display: flex; flex-wrap: wrap; gap: 16px; margin-bottom: 13px;">
                  <div class="form-check" style="display: flex; align-items: center;">
                    <input
                        class="form-check-input"
                        type="radio"
                        name="rowSelect"
                        value="region"
                        id="RowRegion"
                        style="margin-right: 8px;"
                    />
                    <label class="form-check-label" for="RowRegion">ì§€ì—­(ì‹œ)/êµ¬ì¶•ë¬¼</label>
                  </div>
                  <div class="form-check" style="display: flex; align-items: center;">
                    <input
                        class="form-check-input"
                        type="radio"
                        name="rowSelect"
                        value="ageNum"
                        id="ageNum"
                        style="margin-right: 8px;"
                    />
                    <label class="form-check-label" for="ageNum">ë‚˜ì´/êµ¬ì¶•ë¬¼</label>
                  </div>
                </dd>
              </dl>
            </div>
            <div id="selection-container" style="display: flex; gap: 20px; margin-bottom: 10px;">
              <dl style="display: flex; flex-direction: column; gap: 4px;">
                <dt>
                  <label for="columnSelect">ì—´ ì„ íƒ<span class="eq"></span></label>
                </dt>
                <dd style="display: flex; flex-wrap: wrap; gap: 16px; margin-top: -8px;">
                  <div class="form-check region-checkbox" style="display: flex; align-items: center;">
                    <input
                        class="form-check-input"
                        type="checkbox"
                        value="region"
                        id="region"
                        style="margin-right: 8px;"
                    />
                    <label class="form-check-label" for="region">ì§€ì—­(ì‹œ)</label>
                  </div>
                  <div class="form-check" style="display: flex; align-items: center;">
                    <input
                        class="form-check-input"
                        type="checkbox"
                        value="district"
                        id="district"
                        style="margin-right: 8px;"
                    />
                    <label class="form-check-label" for="district">ì§€ì—­(êµ¬êµ°)</label>
                  </div>
                  <div class="form-check" style="display: flex; align-items: center;">
                    <input
                        class="form-check-input"
                        type="checkbox"
                        value="inDatem"
                        id="inDatem"
                        style="margin-right: 8px;"
                    />
                    <label class="form-check-label" for="inDatem">ë°œê¸‰ ì¼ì</label>
                  </div>
                  <div class="form-check" style="display: flex; align-items: center;">
                    <input
                        class="form-check-input"
                        type="checkbox"
                        value="sexYn"
                        id="sexYn"
                        style="margin-right: 8px;"
                    />
                    <label class="form-check-label" for="sexYn">ì„±ë³„</label>
                  </div>
                </dd>
              </dl>
              <dd style="margin-top: 16px;">
                <li>
                  <a class="btn btn-delete" title="ì ìš©" id="addSheetBtn">
                    <img src="/images/icon/btn-srch.svg" alt="ì ìš© ì•„ì´ì½˜"/>
                    í–‰/ì—´ ì¡°ê±´ì ìš©
                  </a>
                </li>
              </dd>
            </div>
            </div>
            <p id="selectedItem"></p>
            <!-- ì´ˆê¸°ì—ëŠ” theGrid í‘œì‹œ -->
            <div id="theGrid" style="max-height: 620px; display: block;"></div>
            <div id="theGrid2" style="max-height: 620px; display: none;"></div>
            <!--                        <div id="theGrid3" style="max-height: 600px; display: none;"></div>-->
          </div>

          <div class="btn-wrap">
          </div>
        </section>
      </div> <!--//tab-contens end-->
    </div> <!--//tab-wrap end-->
  </div> <!--//layout-contents end -->

  <footer style="margin-top: 24px;">
    <p>Copyrightâ“’ 0000 corp. All rights reserved.</p>
  </footer>

</th:block>
<th:block layout:fragment="scripts">
  <th:block th:replace="/common/approve_box :: approve_box"></th:block>
  <th:block th:replace="/common/ax5_uploader :: ax5_uploader"></th:block>
  <th:block th:replace="/common/upload_one_image_box :: upload_one_image_box"></th:block>
  <th:block th:replace="/common/popup_select_user_code :: popup_select_user_code"></th:block>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdn.wijmo.com/5.latest/controls/wijmo.grid.sheet.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function () {
      // í˜„ì¬ ë‚ ì§œ ì„¤ì •
      const today = new Date();
      const year = today.getFullYear();
      const month = today.getMonth();

      // ì‹œì‘ì¼
      const startOfYear = new Date(year, 0, 1);
      const startYearFormatted = `${startOfYear.getFullYear()}-${String(startOfYear.getMonth() + 1).padStart(2, '0')}-${String(startOfYear.getDate()).padStart(2, '0')}`;
      $('#startDate').val(startYearFormatted);

      // ì¢…ë£Œì¼
      const endOfMonth = new Date(year, month + 1, 0);
      const endMonthFormatted = `${endOfMonth.getFullYear()}-${String(endOfMonth.getMonth() + 1).padStart(2, '0')}-${String(endOfMonth.getDate()).padStart(2, '0')}`;
      $('#endDate').val(endMonthFormatted);

    });

    function toggleCheckboxVisibility(selected) {
      // ì²´í¬ë°•ìŠ¤ ìš”ì†Œ ì„ íƒ
      const regionCheckbox = document.querySelector('.region-checkbox');
      const districtCheckbox = document.querySelector('#district').parentElement; // êµ¬êµ° ì²´í¬ë°•ìŠ¤ ë¶€ëª¨
      const allCheckboxes = document.querySelectorAll('#selection-container input[type="checkbox"]'); // ëª¨ë“  ì²´í¬ë°•ìŠ¤ ì„ íƒ

      // ì²´í¬ë°•ìŠ¤ ì´ˆê¸°í™” (ì„ íƒ í•´ì œ)
      allCheckboxes.forEach(checkbox => {
        checkbox.checked = false;
      });

      if (selected === 'ageNum') {
        // ë‚˜ì´ í´ë¦­ ì‹œ ëª¨ë‘ í‘œì‹œ
        regionCheckbox.style.display = 'flex';
        districtCheckbox.style.display = 'flex';
      } else if (selected === 'region') {
        // ì§€ì—­(ì‹œ) í´ë¦­ ì‹œ ì§€ì—­(ì‹œ) ì²´í¬ë°•ìŠ¤ ìˆ¨ê¸°ê¸°
        regionCheckbox.style.display = 'none';
        districtCheckbox.style.display = 'flex';
      } else if (selected === 'district') {
        // êµ¬êµ° í´ë¦­ ì‹œ êµ¬êµ° ì²´í¬ë°•ìŠ¤ ìˆ¨ê¸°ê¸°
        regionCheckbox.style.display = 'flex';
        districtCheckbox.style.display = 'none';
      }
    }

    // ì´ˆê¸°í™”: í˜ì´ì§€ ë¡œë“œ ì‹œ ëª¨ë“  ì²´í¬ë°•ìŠ¤ê°€ ë³´ì´ë„ë¡ ì„¤ì •
    document.addEventListener("DOMContentLoaded", function () {
      // ê¸°ë³¸ ë¼ë””ì˜¤ ë²„íŠ¼ ì„ íƒ (ì§€ì—­ ì„ íƒ)
      document.getElementById("RowRegion").checked = true;

      // ê·¸ë¦¬ë“œ ì´ˆê¸°í™” ë° RegionData() ì‹¤í–‰
      toggleGrid('theGrid2');
      RegionData([], true);

      // ì²´í¬ë°•ìŠ¤ í‘œì‹œ ë¡œì§ ì‹¤í–‰
      toggleCheckboxVisibility('region');
    });

    // ë¼ë””ì˜¤ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì—°ê²°
    document.querySelectorAll('input[name="rowSelect"]').forEach(radio => {
      radio.addEventListener('change', (e) => {
        toggleCheckboxVisibility(e.target.value);
      });
    });

    function toggleGrid(gridToShow) {
      // ëª¨ë“  ê·¸ë¦¬ë“œ ìˆ¨ê¸°ê¸°
      document.getElementById('theGrid').style.display = 'none';
      document.getElementById('theGrid2').style.display = 'none';
      // document.getElementById('theGrid3').style.display = 'none';

      // ì„ íƒí•œ ê·¸ë¦¬ë“œë§Œ í‘œì‹œ
      document.getElementById(gridToShow).style.display = 'block';
      if (gridToShow === 'theGrid') {
        DefaultData(); // ë‚˜ì´ ê·¸ë¦¬ë“œ ë°ì´í„° ì´ˆê¸°í™”
      } else if (gridToShow === 'theGrid2') {
        //RegionData(); // ì§€ì—­ ê·¸ë¦¬ë“œ ë°ì´í„° ì´ˆê¸°í™”
      }
    }

    // ë¼ë””ì˜¤ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ì— ì—°ê²°
    document.getElementById('RowRegion').addEventListener('click', function () {
      toggleGrid('theGrid2'); // ì§€ì—­(ì‹œ) ì„ íƒ ì‹œ theGrid2 í‘œì‹œ
      RegionData([], true);
    });

    document.getElementById('ageNum').addEventListener('click', function () {
      toggleGrid('theGrid'); // ë‚˜ì´ ì„ íƒ ì‹œ theGrid í‘œì‹œ
      updateGridColumns([], true);
    });

    document.getElementById("RowRegion").checked = true;

    document.readyState === 'complete' ? init() : window.onload = init;

    var theGrid;
    var viewdata;

    const columnNames = {
      region: "ì§€ì—­(ì‹œ)",
      district: "ì§€ì—­(êµ¬êµ°)",
      inDatem: "ë“±ë¡ ì¼ì",
      sexYn: "ì„±ë³„"
    };


    function init() {
      RegionData();
    }

    function DefaultData() {

      if (theGrid) {
        theGrid.itemsSource = null; // ë°ì´í„° ì´ˆê¸°í™”
      }

      let data = [];

      // ì„ íƒí•œ ì»¬ëŸ¼ ë¦¬ìŠ¤íŠ¸ë¥¼ ë°°ì—´ë¡œ ë³€í™˜
      const selectedColumns = Object.keys(columnNames);

      const params = {
        startDate: $('#startDate').val(),
        endDate: $('#endDate').val(),
        columns: selectedColumns // ë°°ì—´ì„ ì§ì ‘ ì¶”ê°€
      };

      // Ajax í†µì‹ ì„ í†µí•´ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
      $.ajax({
        url: '/api/report/read',
        type: 'GET',
        data: params,
        traditional: true,// GET ë°©ì‹ì—ì„œ ë°°ì—´ì„ ì •ìƒì ìœ¼ë¡œ ì „ë‹¬
        dataType: 'json',
        success: function (response) {
          console.log("API ì‘ë‹µ ë°ì´í„°:", response);

          if (response && Array.isArray(response.data)) {
            data = response.data.map((item, index) => ({
              rownum: index + 1,
              inDatem: item.inDatem || '',
              region: item.region || '', // ì˜ˆ: 'ê²½ê¸°'
              district: item.district || '', // ì˜ˆ: 'ê³ ì–‘ì‹œ'
              sexYn :item.sexYn ||'' , //ì„±ë³„

              // 10ëŒ€ ì´í•˜ êµ¬ì¶•ë¬¼
              age_10_apartment: item.age_10_apartment || '',
              age_10_villa: item.age_10_villa || '',
              age_10_house: item.age_10_house || '',
              age_10_office: item.age_10_office || '',
              age_10_other: item.age_10_other || '',
              // 20ëŒ€ êµ¬ì¶•ë¬¼
              age_20_apartment: item.age_20_apartment || '',
              age_20_villa: item.age_20_villa || '',
              age_20_house: item.age_20_house || '',
              age_20_office: item.age_20_office || '',
              age_20_other: item.age_20_other || '',
              // 30ëŒ€ êµ¬ì¶•ë¬¼
              age_30_apartment: item.age_30_apartment || '',
              age_30_villa: item.age_30_villa || '',
              age_30_house: item.age_30_house || '',
              age_30_office: item.age_30_office || '',
              age_30_other: item.age_30_other || '',
              // 40ëŒ€êµ¬ì¶•ë¬¼
              age_40_apartment: item.age_40_apartment || '',
              age_40_villa: item.age_40_villa || '',
              age_40_house: item.age_40_house || '',
              age_40_office: item.age_40_office || '',
              age_40_other: item.age_40_other || '',
              //50ëŒ€ êµ¬ì¶•ë¬¼
              age_50_apartment: item.age_50_apartment || '',
              age_50_villa: item.age_50_villa || '',
              age_50_house: item.age_50_house || '',
              age_50_office: item.age_50_office || '',
              age_50_other: item.age_50_other || '',

              //60ëŒ€ êµ¬ì¶•ë¬¼
              age_60_apartment: item.age_60_apartment || '',
              age_60_villa: item.age_60_villa || '',
              age_60_house: item.age_60_house || '',
              age_60_office: item.age_60_office || '',
              age_60_other: item.age_60_other || '',
              //70ëŒ€ ì´ìƒ êµ¬ì¶•ë¬¼
              age_70_apartment: item.age_70_apartment || '',
              age_70_villa: item.age_70_villa || '',
              age_70_house: item.age_70_house || '',
              age_70_office: item.age_70_office || '',
              age_70_other: item.age_70_other || '',
              // ì†Œê³„
              total: item.total || '',
            }));
          }

          // ë°ì´í„°ê°€ 15ê°œ ë¯¸ë§Œì¼ ê²½ìš° ë¹ˆ ë°ì´í„° ì¶”ê°€
          while (data.length < 15) {
            data.push({
              rownum: data.length + 1,
              inDatem: '',
              region: '',
              district: '',
              sexYn: '',
              age_10_apartment: '',
              age_10_villa: '',
              age_10_house: '',
              age_10_office: '',
              age_10_other: '',
              age_20_apartment: '',
              age_20_villa: '',
              age_20_house: '',
              age_20_office: '',
              age_20_other: '',
              age_30_apartment: '',
              age_30_villa: '',
              age_30_house: '',
              age_30_office: '',
              age_30_other: '',
              age_40_apartment: '',
              age_40_villa: '',
              age_40_house: '',
              age_40_office: '',
              age_40_other: '',
              age_50_apartment: '',
              age_50_villa: '',
              age_50_house: '',
              age_50_office: '',
              age_50_other: '',
              age_60_apartment: '',
              age_60_villa: '',
              age_60_house: '',
              age_60_office: '',
              age_60_other: '',
              age_70_apartment: '',
              age_70_villa: '',
              age_70_house: '',
              age_70_office: '',
              age_70_other: '',
              total: '',
            });
          }

          console.log('ì²˜ë¦¬ëœ ë°ì´í„°:', data);

          // ê·¸ë¦¬ë“œì— ë°ì´í„° ì ìš©
          viewdata = new wijmo.collections.CollectionView(data);

          if (!theGrid) {
            theGrid = new wijmo.grid.FlexGrid('#theGrid', {
              allowMerging: 'ColumnHeaders',
              autoGenerateColumns: false,
              selectionMode: wijmo.grid.SelectionMode.Row,
              isReadOnly: true,
              columns: [
                {binding: 'rownum', header: 'NO', width: 70, align: 'center', visible: false},
                {binding: 'inDatem', header: 'ë…„ë„', width: 80, allowMerging: true},
                {binding: 'region', header: 'ì§€ì—­(ì‹œ)', width: 100, allowMerging: true},
                {binding: 'district', header: 'êµ¬êµ°', width: 120 ,allowMerging: true},
                // ì†Œê³„
                {binding: 'total', header: 'í•©ê³„', width: 100, align: 'center'},
                {binding: 'construction', header: 'êµ¬ì¶•ë¬¼', width: 100},


                // 10ëŒ€ ì´í•˜ êµ¬ì¶•ë¬¼
                {binding: 'age_10_apartment', header: 'ì•„íŒŒíŠ¸', width: 100, align: 'center'},
                {binding: 'age_10_villa', header: 'ë¹Œë¼', width: 100, align: 'center'},
                {binding: 'age_10_house', header: 'ë‹¨ë…', width: 100, align: 'center'},
                {binding: 'age_10_office', header: 'ì˜¤í”¼ìŠ¤', width: 100, align: 'center'},
                {binding: 'age_10_other', header: 'ê¸°íƒ€', width: 100, align: 'center'},

                // 20ëŒ€ êµ¬ì¶•ë¬¼
                {binding: 'age_20_apartment', header: 'ì•„íŒŒíŠ¸', width: 100, align: 'center'},
                {binding: 'age_20_villa', header: 'ë¹Œë¼', width: 100, align: 'center'},
                {binding: 'age_20_house', header: 'ë‹¨ë…', width: 100, align: 'center'},
                {binding: 'age_20_office', header: 'ì˜¤í”¼ìŠ¤', width: 100, align: 'center'},
                {binding: 'age_20_other', header: 'ê¸°íƒ€', width: 100, align: 'center'},

                // 30ëŒ€ êµ¬ì¶•ë¬¼
                {binding: 'age_30_apartment', header: 'ì•„íŒŒíŠ¸', width: 100, align: 'center'},
                {binding: 'age_30_villa', header: 'ë¹Œë¼', width: 100, align: 'center'},
                {binding: 'age_30_house', header: 'ë‹¨ë…', width: 100, align: 'center'},
                {binding: 'age_30_office', header: 'ì˜¤í”¼ìŠ¤', width: 100, align: 'center'},
                {binding: 'age_30_other', header: 'ê¸°íƒ€', width: 100, align: 'center'},

                // 40ëŒ€ êµ¬ì¶•ë¬¼
                {binding: 'age_40_apartment', header: 'ì•„íŒŒíŠ¸', width: 100, align: 'center'},
                {binding: 'age_40_villa', header: 'ë¹Œë¼', width: 100, align: 'center'},
                {binding: 'age_40_house', header: 'ë‹¨ë…', width: 100, align: 'center'},
                {binding: 'age_40_office', header: 'ì˜¤í”¼ìŠ¤', width: 100, align: 'center'},
                {binding: 'age_40_other', header: 'ê¸°íƒ€', width: 100, align: 'center'},

                // 50ëŒ€ êµ¬ì¶•ë¬¼
                {binding: 'age_50_apartment', header: 'ì•„íŒŒíŠ¸', width: 100, align: 'center'},
                {binding: 'age_50_villa', header: 'ë¹Œë¼', width: 100, align: 'center'},
                {binding: 'age_50_house', header: 'ë‹¨ë…', width: 100, align: 'center'},
                {binding: 'age_50_office', header: 'ì˜¤í”¼ìŠ¤', width: 100, align: 'center'},
                {binding: 'age_50_other', header: 'ê¸°íƒ€', width: 100, align: 'center'},

                // 60ëŒ€ êµ¬ì¶•ë¬¼
                {binding: 'age_60_apartment', header: 'ì•„íŒŒíŠ¸', width: 100, align: 'center'},
                {binding: 'age_60_villa', header: 'ë¹Œë¼', width: 100, align: 'center'},
                {binding: 'age_60_house', header: 'ë‹¨ë…', width: 100, align: 'center'},
                {binding: 'age_60_office', header: 'ì˜¤í”¼ìŠ¤', width: 100, align: 'center'},
                {binding: 'age_60_other', header: 'ê¸°íƒ€', width: 100, align: 'center'},

                // 70ëŒ€  ì´ìƒ êµ¬ì¶•ë¬¼
                {binding: 'age_70_apartment', header: 'ì•„íŒŒíŠ¸', width: 100, align: 'center'},
                {binding: 'age_70_villa', header: 'ë¹Œë¼', width: 100, align: 'center'},
                {binding: 'age_70_house', header: 'ë‹¨ë…', width: 100, align: 'center'},
                {binding: 'age_70_office', header: 'ì˜¤í”¼ìŠ¤', width: 100, align: 'center'},
                {binding: 'age_70_other', header: 'ê¸°íƒ€', width: 100, align: 'center'},


              ],
              itemsSource: viewdata,
              allowMerging: 'Cells',
            });

            // hostElementì— í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
            theGrid.hostElement.addEventListener('click', (e) => {
              const ht = theGrid.hitTest(e);
              if (ht.cellType === wijmo.grid.CellType.Cell) {
                const rowIndex = ht.row;
                const colIndex = ht.col;
                const item = theGrid.rows[rowIndex].dataItem;
                const columnBinding = theGrid.columns[colIndex].binding; // ì»¬ëŸ¼ì˜ binding ê°’ (ì˜ˆ: "age_10_apartment")

                // ë™ì ìœ¼ë¡œ ì¶”ê°€ëœ ë°ì´í„° ì¶”ì¶œ
                let dynamicData = {};
                Object.keys(columnNames).forEach(key => {
                  if (item.hasOwnProperty(key)) {
                    dynamicData[key] = item[key];
                  }
                });

                // ì—°ë ¹ëŒ€ êµ¬ë¶„ì„ binding ê°’ ê¸°ë°˜ìœ¼ë¡œ ìë™ ë§¤í•‘
                let ageGroup = '';
                const ageMatch = columnBinding.match(/age_(\d+)_/); // 'age_10_apartment' â†’ '10' ì¶”ì¶œ
                if (ageMatch) {
                  const age = parseInt(ageMatch[1]); // ì •ìˆ˜ ë³€í™˜
                  if (age <= 10) {
                    ageGroup = '10ëŒ€ ì´í•˜';
                  } else if (age <= 20) {
                    ageGroup = '20ëŒ€';
                  } else if (age <= 30) {
                    ageGroup = '30ëŒ€';
                  } else if (age <= 40) {
                    ageGroup = '40ëŒ€';
                  } else if (age <= 50) {
                    ageGroup = '50ëŒ€';
                  } else if (age <= 60) {
                    ageGroup = '60ëŒ€';
                  } else {
                    ageGroup = '70ëŒ€ ì´ìƒ';
                  }
                }

                // êµ¬ì¶•ë¬¼ ìœ í˜• ì¶”ì¶œ (ì˜ˆ: 'ì•„íŒŒíŠ¸', 'ë¹Œë¼')
                let buildingType = columnBinding.replace(/age_\d+_/, ''); // ì—°ë ¹ëŒ€ ë¶€ë¶„ ì œê±°í•˜ì—¬ êµ¬ì¶•ë¬¼ íƒ€ì…ë§Œ ë‚¨ê¹€

                // API í˜¸ì¶œì— í•„ìš”í•œ ë°ì´í„° ê°ì²´ ìƒì„±
                const params = {
                  startDate: $('#startDate').val(),
                  endDate: $('#endDate').val(),
                  ageGroup: ageGroup,
                  buildingType: buildingType,
                  ...dynamicData
                };

                console.log("API ìš”ì²­ íŒŒë¼ë¯¸í„°:", JSON.stringify(params, null, 2));
                // API í˜¸ì¶œ ë˜ëŠ” ë°ì´í„° ì²˜ë¦¬
                fetchCellData(params);
              }
            });


            const headerRow1 = new wijmo.grid.Row();

            headerRow1.allowMerging = true; // ë³‘í•© í—ˆìš©

            theGrid.columnHeaders.rows.splice(0, 0, headerRow1); // ì²« ë²ˆì§¸ ì¤„ ì¶”ê°€

            const panel = theGrid.columnHeaders;

            // ì²« ë²ˆì§¸ í—¤ë” ì¤„
            panel.setCellData(0, 1, 'êµ¬ë¶„');
            panel.setCellData(0, 5, 'ë‚˜ì´');

            // ë‘ ë²ˆì§¸ í—¤ë” ì¤„
            panel.setCellData(0, 6, '10ëŒ€ ì´í•˜');
            panel.setCellData(0, 11, '20ëŒ€');
            panel.setCellData(0, 16, '30ëŒ€');
            panel.setCellData(0, 21, '40ëŒ€');
            panel.setCellData(0, 26, '50ëŒ€');
            panel.setCellData(0, 31, '60ëŒ€');
            panel.setCellData(0, 36, '70ëŒ€ ì´ìƒ');

            theGrid.rowHeaders.columns.splice(0, 1);
            // ContextMenu ì¶”ê°€
            new FlexGridContextMenu(theGrid);
            window.downloadFileName = 'í†µê³„ë³´ê³ ì„œ_ë‚˜ì´';

          } else {
            theGrid.itemsSource = viewdata;
          }
        },
        error: function () {
          console.error("ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
        }
      });
      // ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì—°ê²°
      document.getElementById('addSheetBtn').onclick = applyChanges;
    }

    function fetchCellData(params) {
      $.ajax({
        url: '/api/report/getUserInfo', // ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ì œê³µí•  ì—”ë“œí¬ì¸íŠ¸
        type: 'GET',
        data: params,
        success: function (response) {
          console.log("âœ… API ì‘ë‹µ ë°ì´í„°:", response);

          if (!response || !Array.isArray(response) || response.length === 0) {
            console.warn("âš ï¸ ì„œë²„ì—ì„œ ë°›ì€ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
            return;
          }

          downloadExcel(response, params);
        },
        error: function () {
          console.error("âŒ ì…€ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
          alert("ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
        }
      });
    }

    function downloadExcel(data, params) {
      if (!Array.isArray(data)) {
        console.error("ë°ì´í„°ê°€ ë°°ì—´ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤:", data);
        return;
      }

      // í—¤ë” ìƒì„± (ì²« ë²ˆì§¸ ê°ì²´ì˜ í‚¤ ì‚¬ìš©)
      const headers = Object.keys(data[0]);

      // ë°ì´í„° ìƒì„± (ë°°ì—´ì˜ ê° ê°ì²´ ê°’ì„ 2ì°¨ì› ë°°ì—´ë¡œ ë³€í™˜)
      const worksheetData = [headers]; // ì²« ë²ˆì§¸ í–‰ì— í—¤ë” ì¶”ê°€
      data.forEach(item => {
        worksheetData.push(Object.values(item));
      });

      // SheetJSë¥¼ ì‚¬ìš©í•˜ì—¬ ì›Œí¬ì‹œíŠ¸ ìƒì„±
      const ws = XLSX.utils.aoa_to_sheet(worksheetData);

      // ì›Œí¬ë¶ ìƒì„± ë° ì›Œí¬ì‹œíŠ¸ ì¶”ê°€
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "í†µê³„ë³´ê³ ì„œ");

      // í˜„ì¬ ë‚ ì§œ ê°€ì ¸ì˜¤ê¸°
      const now = new Date();
      const formattedDate =
        now.getFullYear() +
        "-" +
        String(now.getMonth() + 1).padStart(2, "0") +
        "-" +
        String(now.getDate()).padStart(2, "0");

      // íŒŒì¼ ì´ë¦„ ìƒì„± (ê°’ì´ ì—†ì„ ê²½ìš° 'N/A' ì²˜ë¦¬)
      const region = params.region || "N/A";
      const district = params.district || "N/A";
      const ageGroup = params.ageGroup || "N/A";
      const buildingType = params.buildingType || "N/A";

      const excelFileName = `í†µê³„ë³´ê³ ì„œ_${region}_${district}_${ageGroup}_${buildingType}_${formattedDate}.xlsx`;

      console.log("ë‹¤ìš´ë¡œë“œ íŒŒì¼ëª…:", excelFileName); // íŒŒì¼ëª… í™•ì¸

      XLSX.writeFile(wb, excelFileName);
    }


    function applyChanges() {
      const selectedRows = Array.from(
        document.querySelectorAll('#selection-container .form-check-input:checked')

      ).map((checkbox) => checkbox.value);

      // console.log('ì„ íƒëœ ì—´ë“¤:', selectedRows);
      DefaultData(selectedRows);
      updateGridColumns(selectedRows);
    }

    function updateGridColumns(selectedRows) {

      if (!theGrid) {
        console.error('FlexGridê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
        return;
      }

      // í•­ìƒ ìœ ì§€í•´ì•¼ í•˜ëŠ” ê¸°ë³¸ ì—´ ëª©ë¡
      const alwaysColumns = [
        'rownum', 'construction',
        'age_10_apartment', 'age_10_villa', 'age_10_house', 'age_10_office', 'age_10_other',
        'age_20_apartment', 'age_20_villa', 'age_20_house', 'age_20_office', 'age_20_other',
        'age_30_apartment', 'age_30_villa', 'age_30_house', 'age_30_office', 'age_30_other',
        'age_40_apartment', 'age_40_villa', 'age_40_house', 'age_40_office', 'age_40_other',
        'age_50_apartment', 'age_50_villa', 'age_50_house', 'age_50_office', 'age_50_other',
        'age_60_apartment', 'age_60_villa', 'age_60_house', 'age_60_office', 'age_60_other',
        'age_70_apartment', 'age_70_villa', 'age_70_house', 'age_70_office', 'age_70_other',
        'total'
      ];

      // ë™ì ìœ¼ë¡œ ì¶”ê°€ë  ì—´ ëª©ë¡
      const dynamicColumns = selectedRows;

      // ìœ ì§€í•´ì•¼ í•  ëª¨ë“  ì—´ (ê¸°ë³¸ ì—´ + ì„ íƒëœ ì—´)
      const allSelectedColumns = [...alwaysColumns, ...dynamicColumns];

      // í˜„ì¬ ê·¸ë¦¬ë“œì— ìˆëŠ” ì—´ ëª©ë¡
      const existingColumns = theGrid.columns.map(col => col.binding);

      // **1. ê¸°ì¡´ ì—´ ì¤‘ ì œê±° ëŒ€ìƒ í™•ì¸ ë° ì œê±°**
      for (let i = existingColumns.length - 1; i >= 0; i--) {
        const col = existingColumns[i];
        if (!allSelectedColumns.includes(col)) { // ìœ ì§€í•´ì•¼ í•  ì—´ ëª©ë¡ì— í¬í•¨ë˜ì§€ ì•Šìœ¼ë©´ ì œê±°
          theGrid.columns.removeAt(i);
        }
      }

      // **2. ì¶”ê°€í•´ì•¼ í•  ì—´ ì¶”ê°€**
      let insertionIndex = existingColumns.indexOf('rownum') + 1; // rownum ë‹¤ìŒì— ì¶”ê°€
      dynamicColumns.forEach((col) => {
        if (!existingColumns.includes(col)) {
          theGrid.columns.splice(insertionIndex, 0, new wijmo.grid.Column({
            binding: col,
            header: columnNames[col] || col,
            width: 150,
            align: 'center',
          }));
          insertionIndex++; // ë‹¤ìŒ ì—´ì€ ë°”ë¡œ ë’¤ì— ì¶”ê°€ë˜ë„ë¡ ì¸ë±ìŠ¤ ì¦ê°€
        }
      });

    //  console.log('theGrid ì—…ë°ì´íŠ¸:', theGrid.columns.map(col => col.binding));
    }


    //ë‚˜ì´ ê·¸ë¦¬ë“œ í•¨ìˆ˜ ë --------------

    var theGrid2;
    var viewdata2;

    // ì§€ì—­ ì´ë¦„ ë°°ì—´
    const regions = [
      'ì„œìš¸íŠ¹ë³„ì‹œ', 'ë¶€ì‚°ê´‘ì—­ì‹œ', 'ëŒ€êµ¬ê´‘ì—­ì‹œ', 'ì¸ì²œê´‘ì—­ì‹œ', 'ê´‘ì£¼ê´‘ì—­ì‹œ',
      'ëŒ€ì „ê´‘ì—­ì‹œ', 'ìš¸ì‚°ê´‘ì—­ì‹œ', 'ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ', 'ê²½ê¸°ë„', 'ê°•ì›ë„',
      'ì¶©ì²­ë¶ë„', 'ì¶©ì²­ë‚¨ë„', 'ì „ë¼ë¶ë„', 'ì „ë¼ë‚¨ë„', 'ê²½ìƒë¶ë„', 'ê²½ìƒë‚¨ë„', 'ì œì£¼íŠ¹ë³„ìì¹˜ë„'
    ];

    // í•˜ìœ„ í•­ëª© ë°°ì—´
    const subCategories = ['ì•„íŒŒíŠ¸', 'ë¹Œë¼', 'ë‹¨ë…', 'ì˜¤í”¼ìŠ¤', 'ê¸°íƒ€'];

    // ì´ˆê¸° ì»¬ëŸ¼ ë°°ì—´
    const columns = [
      {binding: 'rownum', header: 'NO', width: 70, align: 'center', visible: false},
      {binding: 'inDatem', header: 'ë…„ë„', width: 80, allowMerging: true},
      {binding: 'district', header: 'êµ¬êµ°', width: 120},
      {binding: 'construction', header: 'êµ¬ì¶•ë¬¼', width: 100}
    ];

    // ì§€ì—­ê³¼ í•˜ìœ„ í•­ëª©ì„ ê¸°ë°˜ìœ¼ë¡œ ì»¬ëŸ¼ ë™ì  ì¶”ê°€
    regions.forEach(region => {
      const regionKey = region.replace(/[^a-zA-Zê°€-í£]/g, '').toLowerCase(); // í‚¤ ìƒì„± (íŠ¹ìˆ˜ë¬¸ì ì œê±°)
      subCategories.forEach(subCategory => {
        const subKey = subCategory.replace(/[^a-zA-Zê°€-í£]/g, '').toLowerCase(); // í•˜ìœ„ í•­ëª© í‚¤ ìƒì„±
        columns.push({
          binding: `${regionKey}_${subKey}`, // ë°ì´í„° ë°”ì¸ë”© í‚¤ (ì˜ˆ: seoul_apartment)
          header: ` ${subCategory}`, // í—¤ë” ì´ë¦„ (ì˜ˆ: " ì•„íŒŒíŠ¸")
          width: 150,
          align: 'center'
        });
      });
    });

    // ì†Œê³„ ì»¬ëŸ¼ ì¶”ê°€
    columns.push({binding: 'total', header: 'í•©ê³„', width: 100, align: 'center'});

    // ìƒì„±ëœ ì»¬ëŸ¼ ì¶œë ¥ (FlexGridì— ì‚¬ìš© ê°€ëŠ¥)
    //  console.log(columns);


    function RegionData() {
      let data2 = [];

      const params = {
        startDate: $('#startDate').val(),
        endDate: $('#endDate').val(),
      };
      // Ajax í†µì‹ ì„ í†µí•´ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
      $.ajax({
        url: '/api/report/read2',
        type: 'GET',
        data: params,
        dataType: 'json',
        success: function (response) {
          console.log("API ì§€ì—­(ì‹œ) ì‘ë‹µ ë°ì´í„°:", response);

          if (response && Array.isArray(response.data2)) {
            console.log("ğŸ“¢ API ì‘ë‹µ ë°ì´í„° í¬ê¸°:", response.data2.length);

            data2 = response.data2.map((item, index) => {
              console.log("ğŸ” í˜„ì¬ ì²˜ë¦¬ ì¤‘ì¸ API ì‘ë‹µ ê°ì²´:", item);

              const rowData = {
                rownum: index + 1,
                inDatem: item.inDatem || '',
                district: item.district || '', // êµ¬êµ° ì •ë³´
                region : item.region || '',

              };

              console.log("ğŸ“¢ regions ë°°ì—´:", regions);
              console.log("ğŸ“¢ subCategories ë°°ì—´:", subCategories);

              // ì§€ì—­ë³„ ë°ì´í„° ì¶”ê°€
              regions.forEach(region => {
                subCategories.forEach(subCategory => {
                  const regionKey = region.replace(/[^a-zA-Zê°€-í£]/g, '').toLowerCase();
                  const subKey = subCategory.replace(/[^a-zA-Zê°€-í£]/g, '').toLowerCase();
                  const dataKey = `${regionKey}_${subKey}`;


                  console.log("ğŸ›  ë§¤í•‘í•  í‚¤:", dataKey);
                  console.log("ğŸ” ì‹¤ì œ API ì‘ë‹µ ë°ì´í„°ì—ì„œ ì°¾ì€ ê°’:", item[dataKey]);

                  rowData[dataKey] = item[dataKey] ?? ''; // ë°ì´í„° ë§¤í•‘
                });
              });

              rowData.total = item.total || ''; // ì†Œê³„
              return rowData;
            });
          }

          // ë°ì´í„°ê°€ 15ê°œ ë¯¸ë§Œì¼ ê²½ìš° ë¹ˆ ë°ì´í„° ì¶”ê°€
          while (data2.length < 15) {
            const emptyRow = { rownum: data2.length + 1 };
            regions.forEach(region => {
              subCategories.forEach(subCategory => {
                const dataKey = `${region}_${subCategory}`;
                emptyRow[dataKey] = ''; // ë¹ˆ ë°ì´í„° ì¶”ê°€
              });
            });
            emptyRow.total = ''; // ì†Œê³„
            data2.push(emptyRow);
          }
          console.log('âœ… ìµœì¢… ì²˜ë¦¬ëœ ë°ì´í„°:', data2);

          // ê·¸ë¦¬ë“œì— ë°ì´í„° ì ìš©
          viewdata2 = new wijmo.collections.CollectionView(data2);

          if (!theGrid2) {
            theGrid2 = new wijmo.grid.FlexGrid('#theGrid2', {
              allowMerging: 'ColumnHeaders',
              autoGenerateColumns: false,
              selectionMode: wijmo.grid.SelectionMode.Row,
              isReadOnly: true,
              columns: columns,
              itemsSource: viewdata2,
              allowMerging: 'Cells',
            });


            const headerRow1 = new wijmo.grid.Row();

            headerRow1.allowMerging = true; // ë³‘í•© í—ˆìš©

            theGrid2.columnHeaders.rows.splice(0, 0, headerRow1); // ì²« ë²ˆì§¸ ì¤„ ì¶”ê°€

            const panel = theGrid2.columnHeaders;

            // ì²« ë²ˆì§¸ í—¤ë” ì¤„
            panel.setCellData(0, 1, 'êµ¬ë¶„');
            panel.setCellData(0, 4, 'ì§€ì—­');
            panel.setCellData(0, 40, 'í•©ê³„');

            // ì²« ë²ˆì§¸ í—¤ë” ì¤„ êµ¬ì„±
            panel.setCellData(0, 5, 'ì„œìš¸íŠ¹ë³„ì‹œ');
            panel.setCellData(0, 10, 'ë¶€ì‚°ê´‘ì—­ì‹œ');
            panel.setCellData(0, 15, 'ëŒ€êµ¬ê´‘ì—­ì‹œ');
            panel.setCellData(0, 20, 'ì¸ì²œê´‘ì—­ì‹œ');
            panel.setCellData(0, 25, 'ê´‘ì£¼ê´‘ì—­ì‹œ');
            panel.setCellData(0, 30, 'ëŒ€ì „ê´‘ì—­ì‹œ');
            panel.setCellData(0, 35, 'ìš¸ì‚°ê´‘ì—­ì‹œ');
            panel.setCellData(0, 40, 'ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ');
            panel.setCellData(0, 45, 'ê²½ê¸°ë„');
            panel.setCellData(0, 50, 'ê°•ì›ë„');
            panel.setCellData(0, 55, 'ì¶©ì²­ë¶ë„');
            panel.setCellData(0, 60, 'ì¶©ì²­ë‚¨ë„');
            panel.setCellData(0, 65, 'ì „ë¼ë¶ë„');
            panel.setCellData(0, 70, 'ì „ë¼ë‚¨ë„');
            panel.setCellData(0, 75, 'ê²½ìƒë¶ë„');
            panel.setCellData(0, 80, 'ê²½ìƒë‚¨ë„');
            panel.setCellData(0, 85, 'ì œì£¼íŠ¹ë³„ìì¹˜ë„');

            theGrid2.rowHeaders.columns.splice(0, 1);
            // ContextMenu ì¶”ê°€
            new FlexGridContextMenu(theGrid2);
            window.downloadFileName = 'í†µê³„ë³´ê³ ì„œ';

          } else {
            theGrid2.itemsSource = viewdata2;
            console.log('ê·¸ë¦¬ë“œ ë°ì´í„° ë°”ì¸ë”© í›„:', theGrid2.itemsSource);
          }
        },
        error: function () {
          console.error("ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
        }
      });
      // ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì—°ê²°
      document.getElementById('addSheetBtn').onclick = applyChanges2;
    }

    function applyChanges2() {
      const selectedRows = Array.from(
        document.querySelectorAll('#selection-container .form-check-input:checked')
      ).map((checkbox) => checkbox.value);

      //console.log('ì„ íƒëœ ì—´ë“¤:', selectedRows);

      updateGridColumns2(selectedRows);
    }

    function updateGridColumns2(selectedRows) {

      if (!theGrid2) {
        console.error('FlexGrid2ê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
        return;
      }

      // í•­ìƒ ìœ ì§€í•´ì•¼ í•˜ëŠ” ê¸°ë³¸ ì—´ ëª©ë¡
      const alwaysColumns2 = [
        {binding: 'rownum', header: 'NO', width: 70, align: 'center', visible: false},
        {binding: 'construction', header: 'êµ¬ì¶•ë¬¼', width: 100}
      ];

      // ì§€ì—­ê³¼ í•˜ìœ„ í•­ëª© ì—´ ì¶”ê°€
      regions.forEach(region => {
        const regionKey = region.replace(/[^a-zA-Zê°€-í£]/g, '').toLowerCase(); // í‚¤ ìƒì„±
        subCategories.forEach(subCategory => {
          const subKey = subCategory.replace(/[^a-zA-Zê°€-í£]/g, '').toLowerCase(); // í•˜ìœ„ í•­ëª© í‚¤ ìƒì„±
          alwaysColumns2.push({
            binding: `${regionKey}_${subKey}`, // ë°ì´í„° ë°”ì¸ë”© í‚¤
            header: `${region} ${subCategory}`, // í—¤ë” ì´ë¦„
            width: 150,
            align: 'center'
          });
        });
      });

      // ë™ì ìœ¼ë¡œ ì¶”ê°€í•  ì—´ ìƒì„± (ì²´í¬ë°•ìŠ¤ì—ì„œ ì„ íƒëœ ì—´ë§Œ ì¶”ê°€)
      const dynamicColumns2 = [];
      selectedRows.forEach(binding => {
        dynamicColumns2.push({
          binding: binding,
          header: columnNames[binding] || binding, // ê¸°ë³¸ì ìœ¼ë¡œ bindingì„ headerë¡œ ì„¤ì •
          width: 150,
          align: 'center'
        });
      });

      // ìµœì¢… ìœ ì§€í•´ì•¼ í•  ì—´ ëª©ë¡ (ê¸°ë³¸ ì—´ + ì„ íƒëœ ì—´)
      const allColumns = [...alwaysColumns2, ...dynamicColumns2];

      // í˜„ì¬ FlexGridì— ìˆëŠ” ì—´ ëª©ë¡
      const existingColumns = theGrid2.columns.map(col => col.binding);

      // **1. ê¸°ì¡´ ì—´ ì¤‘ ì œê±° ëŒ€ìƒ í™•ì¸ ë° ì œê±°**
      for (let i = existingColumns.length - 1; i >= 0; i--) {
        const col = existingColumns[i];
        if (!allColumns.some(c => c.binding === col)) {
          // console.log(`Removing column: ${col}`); // ë””ë²„ê¹…ìš© ë¡œê·¸
          theGrid2.columns.removeAt(i);
        }
      }

      // **2. ì¶”ê°€í•´ì•¼ í•  ì—´ ì¶”ê°€**
      allColumns.forEach((col, index) => {
        if (!existingColumns.includes(col.binding)) {
          // console.log(`Adding column: ${col.binding}`); // ë””ë²„ê¹…ìš© ë¡œê·¸

          // rownumì˜ ë‹¤ìŒ ìœ„ì¹˜ë¥¼ ê³„ì‚°
          const rownumIndex = theGrid2.columns.findIndex(c => c.binding === 'rownum');
          const insertionIndex = rownumIndex !== -1 ? rownumIndex + 1 : 0; // rownumì´ ì—†ìœ¼ë©´ ë§¨ ì•ì— ì¶”ê°€

          theGrid2.columns.splice(insertionIndex, 0, new wijmo.grid.Column({
            binding: col.binding,
            header: col.header || col.binding, // headerê°€ ì—†ìœ¼ë©´ binding ì‚¬ìš©
            width: col.width || 100,
            align: col.align || 'center',
            visible: col.visible !== undefined ? col.visible : true,
            allowMerging: col.allowMerging || false
          }));
        }
      });

      //console.log('theGrid2 ì—…ë°ì´íŠ¸:', theGrid2.columns.map(col => col.binding));
    }

    //ì§€ì—­(ì‹œ) ë ################################################


  </script>
</th:block>

</html>