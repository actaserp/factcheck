<html layout:decorate="~{layout_page}" xmlns:layout="http://www.w3.org/1999/xhtml">
<style>
    .section-item{
        order: 0;
    }
</style>
<th:block layout:fragment="content">

    <!--- (레이아웃) Contents 영역 -->
    <div class="layout-contents">
        <!-- Page Title -->
        <div class="page-title-wrap">
            <div class="left">
                <h2>FACT CHECK 모니터링</h2>
<!--                <a id="toggleButton" onclick="toggleSearchWrap()"><img src="/images/icon/ico-down.png"-->
<!--                                                                       alt="알람 아이콘"></a>-->
            </div>
            <ul class="page-navi">
                <li><img src="/images/icon/ico-nav-home.svg" alt="홈아이콘"></li>
            </ul>
        </div>
        <!-- Select -->
        <div class="search-wrap" id="searchWrap" style="display: none">
            <ul>
                <li>
                    <select title="지역">
                        <option>대구</option>
                    </select>
                </li>
                <li>
                    <select title="구">
                        <option>성서산단</option>
                    </select>
                </li>
                <li>
                    <select title="동">
                        <option>성서</option>
                    </select>
                </li>
            </ul>
            <div class="card-btn-wrap">
                <div class="btn swiper-button-prev"></div>
                <div class="btn swiper-button-next"></div>
                <a title="카드설정" class="btn btn-popup-open" data-popup="popup1">
                    <img src="/images/icon/btn-setting.svg" alt="설정아이콘">
                </a>
            </div>
        </div>
        <div class="row row-1" style="margin-bottom: 0;">
            <div class="card-wrap swiper card-swiper">
                <div class="swiper-wrapper">
                    <div class="swiper-slide">
                        <section>
                            <div class="title">
                                <h3>금일신규사용자</h3>
                                <a href="#" title="더보기" class="btn-plus"></a>
                            </div>
                            <dl>
                                <dt>신규사용자</dt>
                                <dd>
                                    100 <span class="unit">명</span>
                                </dd>
                            </dl>
                            <dl>
                                <dt>전일대비</dt>
                                <dd>
                                    <span class="down"></span> 1.20 <span class="unit">%</span>
                                </dd>
                            </dl>
                        </section>
                    </div>
                    <div class="swiper-slide">
                        <section>
                            <div class="title">
                                <h3>금일상위검색지역</h3>
                                <a href="#" title="더보기" class="btn-plus"></a>
                            </div>
                            <dl>
                                <dt>검색지역</dt>
                                <dd>
                                    강남구 <span class="unit"></span>
                                </dd>
                            </dl>
                            <dl>
                                <dt>전일대비</dt>
                                <dd>
                                    <span class="up"></span> 2.20 <span class="unit">%</span>
                                </dd>
                            </dl>
                        </section>
                    </div>
                    <div class="swiper-slide">
                        <section>
                            <div class="title">
                                <h3>총가입자 수</h3>
                                <a href="#" title="더보기" class="btn-plus"></a>
                            </div>
                            <dl>
                                <dt>가입자 수</dt>
                                <dd>
                                    9,999 <span class="unit">명</span>
                                </dd>
                            </dl>
                            <dl>
                                <dt>전월대비증가율</dt>
                                <dd>
                                    <span class="up"></span> 39.0 <span class="unit">%</span>
                                </dd>
                            </dl>
                        </section>
                    </div>
                    <div class="swiper-slide">
                        <section>
                            <div class="title">
                                <h3>금일 등기열람건수</h3>
                                <a href="#" title="더보기" class="btn-plus"></a>
                            </div>
                            <dl>
                                <dt>건수</dt>
                                <dd>
                                    100 <span class="unit">건</span>
                                </dd>
                            </dl>
                            <dl>
                                <dt>전일대비</dt>
                                <dd>
                                    <span class="up"></span> 1.20 <span class="unit">%</span>
                                </dd>
                            </dl>
                        </section>
                    </div>
                    <div class="swiper-slide">
                        <section>
                            <div class="title">
                                <h3>미답변문의건수</h3>
                                <a href="#" title="더보기" class="btn-plus"></a>
                            </div>
                            <dl>
                                <dt>건수</dt>
                                <dd>
                                    10 <span class="unit">건</span>
                                </dd>
                            </dl>
                            <dl>
                                <dt>전일대비</dt>
                                <dd>
                                    <span class="up"></span> 1.20 <span class="unit">%</span>
                                </dd>
                            </dl>
                        </section>
                    </div>
                </div> <!--//swiper-wrapper end -->
            </div> <!--//main-card-wrap end -->
        </div>
        <div class="row row-2">
            <section class="wp50" style="height: 678px">
                <div class="title-wrap">
                    <h3>금일 신규 사용자</h3>
                </div>
                <div class="">
                    <div id="theGrid1" style="height: 247px"></div>
                </div>
                <div class="title-wrap" style="margin-top: 16px">
                    <h3>금일 상위 검색지역</h3>
                </div>
                <div class="">
                    <div id="theGrid2" style="height: 247px"></div>
                </div>
            </section>
            <div class="col wp50">
                <section>
                    <div class="title-wrap">
                        <h3>일주일 가입자현황</h3>
                        <ul class="tab-links-sub">
                            <li>
                                <a href="#tab1" title="일주일" style="padding: 3px 10px 3px 10px;">10.1~10.7(주간)</a>
                            </li>
                            <li>
                                <a href="#tab2" title="유출자현황" style="padding: 3px 10px 3px 10px;">유출자현황</a>
                            </li>
                            <li>
                                <a href="#tab3" title="등기열람건수" style="padding: 3px 10px 3px 10px;">등기열람건수</a>
                            </li>
                            <li>
                                <a href="#tab4" title="상위검색지역" style="padding: 3px 10px 3px 10px;">상위검색지역</a>
                            </li>
                        </ul>
                    </div>
                    <div class="tab-contents">
                        <!-- tab1 -->
                        <div class="tab-item-sub h280" id="tab1">
                            <div class="chart-wrap">
                                <canvas id="revenueChart" width="740" height="265" style="width: 740px; height: 265px;"></canvas>
<!--                                <span class="material-symbols-outlined" style="position: absolute; top: 17px; right: 3px; cursor: pointer; z-index: 10; color: rgb(179, 179, 179);" onclick="openModal('revenueChart')">zoom_out_map</span>-->
                            </div>
                        </div>
                        <!-- tab1 -->
                        <div class="tab-item-sub h280" id="tab2">
                            <div class="chart-wrap">

                            </div>
                        </div>
                        <!-- tab1 -->
                        <div class="tab-item-sub h280" id="tab3">
                            <div class="chart-wrap">

                            </div>
                        </div>
                        <!-- tab1 -->
                        <div class="tab-item-sub h280" id="tab4">
                            <div class="chart-wrap">

                            </div>
                        </div>
                    </div>
                </section>
                <section style="height: 287px; margin-bottom: 0">
                    <div class="title-wrap">
                        <h3>1:1미답변 문의글</h3>
                    </div>
                    <div class="">
                        <div id="theGrid3" style="height: 200px"></div>
                    </div>
                </section>
            </div>
        </div>
    </div> <!--//layout-contents end -->
    <footer>
        <p>Copyrightⓒ FACT CHECK corp. All rights reserved.</p>
    </footer>
    <div style="height: 10px"></div>

    <!-- [대시보드] 팝업  -->
    <div class="dashboard-layout-popup">
        <div class="popup-overlay"></div>
        <div class="popup-wrapper wp80" id="popup1">
            <div class="popup-title">
                <h3>카드 수정</h3>
                <a title="팝업닫기" class="btn-popup-close">
                    <img src="/images/icon/btn-popup-close.svg" alt="닫기">
                </a>
            </div>
            <div class="popup-contents">
                <div class="card-wrap card-edit-wrap" id="cardwrap">
                    <div class="gesture-box">
                        <img src="/images/icon/ico-gesture.png" alt="제스처 안내">
                    </div>
                    <section class="section-item" data-title="INPUT1">
                        <div class="title">
                            <h3>INPUT1</h3>
                            <a title="숨김" class="btn-hidden"></a>
                        </div>
                        <dl>
                            <dt>LNG사용량</dt>
                            <dd>
                                9,999 <span class="unit">Nm³</span>
                            </dd>
                        </dl>
                        <dl>
                            <dt>전일대비</dt>
                            <dd>
                                <span class="down"></span> 1.20 <span class="unit">%</span>
                            </dd>
                        </dl>
                    </section>
                    <section class="section-item" data-title="Elec. OUTPUT">
                        <div class="title">
                            <h3>Elec. OUTPUT</h3>
                            <a title="숨김" class="btn-hidden"></a>
                        </div>
                        <dl>
                            <dt>전기생산량</dt>
                            <dd>
                                9,999 <span class="unit">kWh</span>
                            </dd>
                        </dl>
                        <dl>
                            <dt>전일대비</dt>
                            <dd>
                                <span class="up"></span> 2.20 <span class="unit">%</span>
                            </dd>
                        </dl>
                    </section>
                    <section  class="section-item" data-title="Heat OUTPUT">
                        <div class="title">
                            <h3>Heat OUTPUT</h3>
                            <a title="숨김" class="btn-hidden"></a>
                        </div>
                        <dl>
                            <dt>열 생산량</dt>
                            <dd>
                                9,999 <span class="unit">Mcal</span>
                            </dd>
                        </dl>
                        <dl>
                            <dt>전일대비</dt>
                            <dd>
                                <span class="down"></span> 1.20 <span class="unit">%</span>
                            </dd>
                        </dl>
                    </section>
                    <section  class="section-item" data-title="F/C Efficiency">
                        <div class="title">
                            <h3>F/C Efficiency</h3>
                            <a title="숨김" class="btn-hidden"></a>
                        </div>
                        <dl>
                            <dt>전기효율</dt>
                            <dd>
                                45.5 <span class="unit">%</span>
                            </dd>
                        </dl>
                        <dl>
                            <dt>열효율</dt>
                            <dd>
                                39.0 <span class="unit">%</span>
                            </dd>
                        </dl>
                    </section>
                    <section  class="section-item" data-title="INCOME">
                        <div class="title">
                            <h3>INCOME</h3>
                            <a title="숨김" class="btn-hidden"></a>
                        </div>
                        <dl>
                            <dt>예상수익</dt>
                            <dd>
                                999,999 <span class="unit">원</span>
                            </dd>
                        </dl>
                        <dl>
                            <dt>전일대비</dt>
                            <dd>
                                <span class="up"></span> 1.20 <span class="unit">%</span>
                            </dd>
                        </dl>
                    </section>

                    <section  class="section-item" data-title="Heat OUTPUT2">
                        <div class="title">
                            <h3>Heat OUTPUT2</h3>
                            <a title="숨김" class="btn-hidden"></a>
                        </div>
                        <dl>
                            <dt>열 생산량</dt>
                            <dd>
                                9,999 <span class="unit">Mcal</span>
                            </dd>
                        </dl>
                        <dl>
                            <dt>전일대비</dt>
                            <dd>
                                <span class="down"></span> 1.20 <span class="unit">%</span>
                            </dd>
                        </dl>
                    </section>
                    <section  class="section-item" data-title="F/C Efficiency2">
                        <div class="title">
                            <h3>F/C Efficiency2</h3>
                            <a title="숨김" class="btn-hidden"></a>
                        </div>
                        <dl>
                            <dt>전기효율</dt>
                            <dd>
                                45.5 <span class="unit">%</span>
                            </dd>
                        </dl>
                        <dl>
                            <dt>열효율</dt>
                            <dd>
                                39.0 <span class="unit">%</span>
                            </dd>
                        </dl>
                    </section>
                    <section class="card-hidden section-item" data-title="INCOME2">
                        <div class="title">
                            <h3>INCOME2</h3>
                            <a title="숨김" class="btn-hidden"></a>
                        </div>
                        <dl>
                            <dt>예상수익</dt>
                            <dd>
                                999,999 <span class="unit">원</span>
                            </dd>
                        </dl>
                        <dl>
                            <dt>전일대비</dt>
                            <dd>
                                <span class="up"></span> 1.20 <span class="unit">%</span>
                            </dd>
                        </dl>
                    </section>
                </div> <!--//swiper-wrapper end -->
            </div>
            <div class="popup-button">
                <button class="btn-popup-close">취소</button>
                <button class="btn-navy" id="btnSave">저장</button>
            </div>
        </div>
    </div>


    <script>
        let csrfToken = $("[name=_csrf]").val();
        var theGrid1;
        var viewdata1;
        var theGrid2;
        var viewdata2;
        var theGrid3;
        var viewdata3;

        // 차트 데이터 설정
        const revenueData = {
            labels: ["월", "화", "수", "목", "금", "토", "일"],
            datasets: [{
                data: [12, 15, 18, 21, 24, 27, 15],
                backgroundColor: 'rgba(98, 178, 253, 0.5)',
                borderColor: 'rgba(98, 178, 253, 1)',
                borderWidth: 1
            }]
        };

        document.readyState === 'complete' ? init() : window.onload = init;

        function init() {
            fetchListData();
            fetchListData2();
            fetchListData3();
            createCharts();
        }

        var swiper = new Swiper(".card-swiper", {
            slidesPerView: 5,
            spaceBetween: 20,
            autoplay: {
                delay: 2500,
                disableOnInteraction: false,
            },
            navigation: {
                nextEl: ".swiper-button-next",
                prevEl: ".swiper-button-prev",
            },
        });

        $('#btnSave').click(function(){

        });

        // 금일 신규 사용자 그리드
        function fetchListData() {
            let data2 = [{},{},{},{},{}];


            // $.ajax({
            //     url: '/api/request/request/read',
            //     type: 'GET',
            //     data: {
            //         'reqnum': $('#reqnum').val()
            //     },
            //     async: false,
            //     success: function (data) {
            //         data2 = data.data;
            //         data2.forEach(item =>{
            //             item.hgrb = getHgrb((item.hgrb));
            //             item.exfmtypedv = getListCgrb2(item.exfmtypedv);
            //             item.infmtypedv = getListCgrb2(item.infmtypedv);
            //             item.stframedv = getListCgrb2(item.stframedv);
            //             item.stexplydv = getListCgrb2(item.stexplydv);
            //             item.originOrdtext = item.ordtext;
            //         })
            //     }
            // })

            viewdata1 = new wijmo.collections.CollectionView(data2);

            if (!theGrid1) {

                // 데이터 그리드에 바인딩
                theGrid1 = new wijmo.grid.FlexGrid('#theGrid1', {
                    autoGenerateColumns: false,
                    showMarquee: true,
                    isReadOnly: true,
                    selectionMode: wijmo.grid.SelectionMode.Row,
                    columns: [
                        {binding: 'no', header: 'No', width: 80, minWidth: 80, align: 'center'},
                        {binding: 'createdDate', header: '등록일', width: 120, align: 'right'},
                        {binding: 'usernm', header: '사용자명', width: 120, align: 'right'},
                        {binding: 'place', header: '지역', width: 100, align: 'right'},
                        {binding: 'age', header: '연령', width: 80, align: 'right'},
                        {binding: 'phone', header: '연락처', width: '*', minWidth: 100, align: 'center'}
                    ],
                    itemsSource: viewdata1,
                });
                // 헤더를 중앙 정렬하는 이벤트 핸들러
                theGrid1.formatItem.addHandler(function (s, e) {
                    if (e.panel === s.columnHeaders) {
                        e.cell.style.textAlign = 'center';
                    }
                });
                theGrid1.rowHeaders.columns.splice(0, 1);  //맨 앞에 헤더부분 없애기
                new FlexGridContextMenu(theGrid1);
                window.downloadFileName = '주문등록';
            } else {
                // 이미 FlexGrid이 존재하는 경우, 데이터만 업데이트
                theGrid1.itemsSource = viewdata1;
            }
        }
        // 금일 상위 검색지역 그리드
        function fetchListData2() {
            let data2 = [{},{},{},{},{}];


            // $.ajax({
            //     url: '/api/request/request/read',
            //     type: 'GET',
            //     data: {
            //         'reqnum': $('#reqnum').val()
            //     },
            //     async: false,
            //     success: function (data) {
            //         data2 = data.data;
            //         data2.forEach(item =>{
            //             item.hgrb = getHgrb((item.hgrb));
            //             item.exfmtypedv = getListCgrb2(item.exfmtypedv);
            //             item.infmtypedv = getListCgrb2(item.infmtypedv);
            //             item.stframedv = getListCgrb2(item.stframedv);
            //             item.stexplydv = getListCgrb2(item.stexplydv);
            //             item.originOrdtext = item.ordtext;
            //         })
            //     }
            // })

            viewdata2 = new wijmo.collections.CollectionView(data2);

            if (!theGrid2) {

                // 데이터 그리드에 바인딩
                theGrid2 = new wijmo.grid.FlexGrid('#theGrid2', {
                    autoGenerateColumns: false,
                    showMarquee: true,
                    isReadOnly: true,
                    selectionMode: wijmo.grid.SelectionMode.Row,
                    columns: [
                        {binding: 'no', header: 'No', width: 80, minWidth: 80, align: 'center'},
                        {binding: 'createdDate', header: '검색일', width: 120, align: 'right'},
                        {binding: 'usernm', header: '사용자명', width: 120, align: 'right'},
                        {binding: 'place', header: '지역', width: 100, align: 'right'},
                        {binding: 'age', header: '점수', width: 100, align: 'right'},
                        {binding: 'phone', header: '조회건수', width: '*', minWidth: 100, align: 'center'}
                    ],
                    itemsSource: viewdata2,
                });
                // 헤더를 중앙 정렬하는 이벤트 핸들러
                theGrid2.formatItem.addHandler(function (s, e) {
                    if (e.panel === s.columnHeaders) {
                        e.cell.style.textAlign = 'center';
                    }
                });

                theGrid2.rowHeaders.columns.splice(0, 1);  //맨 앞에 헤더부분 없애기
                new FlexGridContextMenu(theGrid2);
                window.downloadFileName = '주문등록';
            } else {
                // 이미 FlexGrid이 존재하는 경우, 데이터만 업데이트
                theGrid2.itemsSource = viewdata2;
            }
        }
        // 1:1미답변 문의글 그리드
        function fetchListData3() {
            let data2 = [{},{},{},{}];


            // $.ajax({
            //     url: '/api/request/request/read',
            //     type: 'GET',
            //     data: {
            //         'reqnum': $('#reqnum').val()
            //     },
            //     async: false,
            //     success: function (data) {
            //         data2 = data.data;
            //         data2.forEach(item =>{
            //             item.hgrb = getHgrb((item.hgrb));
            //             item.exfmtypedv = getListCgrb2(item.exfmtypedv);
            //             item.infmtypedv = getListCgrb2(item.infmtypedv);
            //             item.stframedv = getListCgrb2(item.stframedv);
            //             item.stexplydv = getListCgrb2(item.stexplydv);
            //             item.originOrdtext = item.ordtext;
            //         })
            //     }
            // })

            viewdata3 = new wijmo.collections.CollectionView(data2);

            if (!theGrid3) {

                // 데이터 그리드에 바인딩
                theGrid3 = new wijmo.grid.FlexGrid('#theGrid3', {
                    autoGenerateColumns: false,
                    showMarquee: true,
                    isReadOnly: true,
                    selectionMode: wijmo.grid.SelectionMode.Row,
                    columns: [
                        {binding: 'no', header: 'No', width: 80, minWidth: 80, align: 'center'},
                        {binding: 'createdDate', header: '문의일자', width: 120, align: 'right'},
                        {binding: 'usernm', header: '사용자명', width: 100, align: 'right'},
                        {binding: 'place', header: '문의내용', width: 200, align: 'right'},
                        {binding: 'age', header: '연락처', width: 120, align: 'right'},
                        {binding: 'phone', header: '등록시간', width: '*', minWidth: 120, align: 'center'}
                    ],
                    itemsSource: viewdata3,
                });
                // 헤더를 중앙 정렬하는 이벤트 핸들러
                theGrid3.formatItem.addHandler(function (s, e) {
                    if (e.panel === s.columnHeaders) {
                        e.cell.style.textAlign = 'center';
                    }
                });
                theGrid3.rowHeaders.columns.splice(0, 1);  //맨 앞에 헤더부분 없애기
                new FlexGridContextMenu(theGrid3);
                window.downloadFileName = '주문등록';
            } else {
                // 이미 FlexGrid이 존재하는 경우, 데이터만 업데이트
                theGrid3.itemsSource = viewdata3;
            }
        }
        // 차트 생성 함수
        function createCharts() {
            const ctxRevenue = document.getElementById('revenueChart').getContext('2d');

            // 기존 차트 인스턴스가 있으면 제거
            if ($('#revenueChart').data('chart')) {
                $('#revenueChart').data('chart').destroy();
            }

            // 차트 생성 후 인스턴스를 data 속성에 저장
            $('#revenueChart').data('chart', new Chart(ctxRevenue, {
                type: 'bar',
                data: revenueData,
                options: {
                    plugins: {
                        legend: {
                            display: false // 범례 비활성화
                        }
                    },
                    scales: {
                        y: {beginAtZero: true}
                    }
                }
            }));
        }
    </script>
    <!--</body>-->
</th:block>
</html>
